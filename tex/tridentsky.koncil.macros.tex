%%%! no-TeX

\documentclass[a4paper, 12pt]{article}
\usepackage{fontspec}
% RawFeature to fix a bug in LuaTeX in dealing with some OTF font features
\defaultfontfeatures{Ligatures={TeX,Common},RawFeature=+calt,SmallCapsFeatures={Renderer=Basic}}
\usepackage[czech]{babel}
\setmainfont{Libertinus Serif}
\usepackage[
    protrusion = true,
    expansion = true,
    tracking = true,
    factor = 800,
    stretch = 20,
    shrink = 15
]{microtype}
\usepackage{graphicx}
\usepackage{float}
\usepackage[
    colorlinks = true,
    urlcolor = blue
]{hyperref}

\clubpenalty = 10000
\widowpenalty = 10000

\def\title #1\par{\ifhmode\par\fi
    \bgroup
        \fontspec{Libertinus Sans Bold}\fontsize{15pt}{18pt}\selectfont
        \noindent #1\unskip\par
        \vskip 4pt
    \egroup
}

\def\subtitle #1\par{\ifhmode\par\fi
    \bgroup
        \fontspec{Libertinus Sans}\selectfont
        \noindent #1\unskip\par
    \egroup
}

\newdimen\aftertitleskip
\aftertitleskip = 12pt

\def\partitle #1\par{\ifhmode\par\fi
    \vskip 2\baselineskip
    \hbox to \hsize{\hfil
        \scshape #1\unskip\hfil
    }
    \nobreak\vskip \aftertitleskip \nobreak
    \everypar = {\bgroup\setbox0 = \lastbox\egroup\everypar = {}}
}

\def\chaptitle #1: #2\par{\ifhmode\par\fi
    \vskip 3\baselineskip
    \vbox{
        \scshape
        \hbox to \hsize{\strut\hfil
            #1\hfil
        }
        \vskip 8pt
        \dimen0 = 30pt
        \hbox{\hskip \dimen0
            \vbox{
                \dimen1 = \hsize
                \advance\dimen1 by -2\dimen0
                \hsize = \dimen1
                \lefthyphenmin = 999
                \righthyphenmin = 999
                \leftskip = 0pt plus 1fill
                \rightskip = 0pt plus 1fill
                \parfillskip = 0pt
                \parindent = 0pt
                \strut#2\unskip\strut
            }%
        }
    }
    \nobreak\vskip \aftertitleskip \nobreak
    \everypar = {\bgroup\setbox0 = \lastbox\egroup\everypar = {}}
}

\def\autor #1\par{\ifhmode\par\fi
    \bgroup
        \vskip 4em
        \noindent\scshape #1\unskip\par
        \vskip 4pt
    \egroup
}

\def\source #1 {%
    \bgroup
        \fontspec{Libertinus Mono}\fontsize{7pt}{10pt}\selectfont
        \href{#1}{#1}%
    \egroup
}

\def\={\discretionary{-}{-}{-}}

\def\bible #1{\textit{#1}}

\def\decret #1\par{\ifhmode\par\fi
    \vskip 60pt
    \hbox to \hsize{\hfil
        \fontsize{15pt}{18pt}\selectfont\scshape #1\unskip\hfil
    }
}

\def\canonMainTitle #1\par{\decret #1\par\vskip\baselineskip}


\def\canon #1: #2\par{\ifhmode\par\fi
    \vskip \baselineskip
    \noindent 
    \bgroup
        \scshape #1:\space
    \egroup
    #2\unskip\par
}

{
\dimen0 = \hsize
\advance\dimen0 by -6em
\global\parfillskip = 2em plus \dimen0
}

% \overfullrule = 5pt

\def\bye{\end{document}}

\begin{document}

\endinput

